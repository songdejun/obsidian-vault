# 3 正则表达式与正则文法

## 3.1 正则表达式

>**正则表达式**是与**有限自动机**、**正则文法**等价的描述语言的模式。正则表达式的优势是**更直观**的描述短的或简单的字符串，例如你在检查某个字符串是不是邮箱时不会考虑去使用有限自动机或则正则文法。

### 3.1.1 正则表达式形式化定义

**定义3.1** 设$\Sigma$是给定的字母表，那么

1. $\emptyset$，$\lambda$和$a \in \Sigma$都是正则表达式。这些叫做**基本正则表达式**（primitive regular expression）。
2. 如果$r_1$和$r_2$是正则表达式，那么$r_1 + r_2$，$r_1 \cdot r_2$，$r_1^*$和$(r_1)$也是正则表达式。
3. 当且仅当把规则2**有限次**的应用于基本正则表达式得到的符号串，才是正则表达式。

>使用**递归**形式化定义正则表达式。

### 3.1.2 和正则表达式相关的语言

**定义3.2** 使用正则表达式$r$表示的语言$L(r)$，有下面规则定义：

1. $\emptyset$是表示空集的正则表达式。
2. $\lambda$是表示${\lambda}$的正则表达式。
3. 对于每个$a \in \Sigma$，$a$是表示${a}$的正则表达式。
   如果${r_1}$和${r_2}$是正则表达式，那么
4. $L(r_1 + r_2) = L(r_1) \cup L(r_2)$。
5. $L(r_1 \cdot r_2) = L(r_1)L(r_2)$。
6. $L((r_1)) = L(r_1)$。
7. $L(r_1^*) = (L(r_1))^*$。

## 3.2 正则表达式和正则语言之间的联系

>这两个两个名字很相似，但是正则表达式是一个描述正则语言一个数学概念，正则语言是语言的子集，是字符串的集合。如果一个语言是正则语言，那就能找到一个正则表达式来表示它。每一个正则表达式也对应着一种正则语言。

### 3.2.1 正则表达式表示正则语言

**定理3.1** 设$r$是正则表达式，那么一定存在某个非确定型又穷接收器接受$L(r)$。因此，$L(r)$是正则语言。

> 证明思路就是按照正则表达式的定义，为基本正则表达式和递归定义构造对应的NFA形式。

![image.png](https://gitee.com/magus-songdejun/imgbed/raw/master/202501130050454.png)

### 3.3.2 正则语言的正则表达式

> 这里并不是给定一个正则语言找到能表示它的正则表达式，而是给定一个NFA，找到与它等价的正则表达式。

**定理3.2** 设$L$时是正则语言。那么总存在正则表达式$r$，使得$L=L(r)$。

### 3.2.3 描述简单模式的正则表达式

> 如上文，正则表达式的优势的就是能够直观描述简单的模式，那么可以用正则表达式**构造出NFA，再还原成DFA**，DFA可以写成简单的转移矩阵的形式，就可以实现简单的模式匹配程序。如果表格很大的话，还要使用减少状态的方法。

## 3.3 正则文法

> 正则文法是文法的一种简单子类，也是描述正则语言的一种方式。

### 3.3.1 右线性文法和左线性文法

**定义3.3** 文法$G = (V, T, S, P)$称为右线性（right-linear）文法，如果所有的产生式都满足下面的形式
$$
A \rightarrow xB \\
A \rightarrow x
$$

其中，$A, B \in V$，并且$x \in T^*$。所有产生式满足如下两种形式的文法称为左线性（left-linear）文法
$$
A \rightarrow Bx \\
A  \rightarrow x
$$

右线性文法和左线性文法都是正则文法（regular grammar）。

> 注意，正则文法要求产生式中至多有一个变量，在最左或最右侧。变量多的产生式，就算一端满足一个变量的要求，也有可能因为内部的变量产生内部的推到膨胀。
>
> 线性文法（linear-grammar）的定义是在产生式中至多有一个变量，不限制位置。

### 3.3.2 右线性文法生成正则语言

**定理3.3** 设$G = (V, T, S, P)$是右线性文法。那么，$L(G)$是正则语言。

> 证明的思路就是根据文法构造一个自动机。

**证明**：假设$V = {V_0, V_1, ...}$，并且$S = V_0$，产生式的形式为
$$
V_0 \rightarrow x_iV_i \\
V_i \rightarrow x_jV_j \\
V_j \rightarrow x_kV_k \\
... \\
V_{n-1} \rightarrow x_{n-1}V_n
$$

或是
$$
V_i \rightarrow x_i \\
V_j \rightarrow x_j \\
V_k \rightarrow x_k \\
... \\
V_{n-1} \rightarrow x_{n-1} \\
V_n \rightarrow x_n
$$

其中$x_i \in T^*$。构造一个DFA $M=(Q, \Sigma, \delta, q_0, F)$，其中
$$
Q = V \\
\Sigma = T \\
q_0 = S \\
F = \{V_i|V_i \in V \cap V_i \rightarrow x_i\}
$$

对于任意一个产生式形如$V_i \rightarrow x_iV_j$，自动机上相应的转换就是$\sigma^*(V_i,x_i) = V_j$，对于形如$V_i \rightarrow x_i$的产生式，$\sigma^*(V_i,x_i) = V_f$，其中$V_f \in F$。
如果$w$是$L(G)$中的一个符号串，那么因为$G$中的产生式的形式，推导一定是下面的形式进行
$$
V_0 \Rightarrow x_iV_i \\
\Rightarrow x_0x_jV_j \\
\overset{*}{\Rightarrow} x_ix_j...V_n \\
\Rightarrow x_ix_j...x_n = w
$$

也就是使用上述形式的产生式进行推导。容易看出$w$是被$M$接受的，所以$L(G) \subseteq L(M)$。  
反之假设$w$被$M$接受，因为构造$M$的方式，也容易看出$w \in L(G)$。定理得以证明。